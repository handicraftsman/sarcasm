#include "scm.h"

////////////////////////////////////////////////////////////////////////////////
// CONSTRUCTOR
////////////////////////////////////////////////////////////////////////////////
scmval make_parameter(scmval init, scmval converter) {
    scm_parameter_t* param = scm_new(scm_parameter_t);
    if(is_undef(converter))
        param->value = init;
    else
        param->value = call(converter, list1(init));
    return make_ptr(SCM_TYPE_PARAMETER, param);
}

////////////////////////////////////////////////////////////////////////////////
// STANDARD LIBRARY
////////////////////////////////////////////////////////////////////////////////
scmval scm_make_parameter(scmval init, scmval converter) {
    return make_parameter(init, converter);
}

////////////////////////////////////////////////////////////////////////////////
// INITIALIZATION
////////////////////////////////////////////////////////////////////////////////
void init_parameter(scmval env) {
    define(env, "make-parameter", scm_make_parameter, arity_or(1, 2));
}

